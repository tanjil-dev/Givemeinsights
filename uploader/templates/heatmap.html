{% extends "base.html" %}
{% load static %}
{% block content %}
<br><br><br><br><br>
<div class="container">
    <h2 class="mt-5">Upload Excel File for Exploratory Data Analysis</h2><br>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="mb-3">
            <input type="file" name="excel_file" class="form-control" required>
        </div>
        <button type="submit" class="btn btn-primary">Upload and Analyze</button>
    </form>

    {% if eda_html %}
        <hr>
        <h4 class="mt-4">EDA Output</h4>
        <div class="border p-3 bg-white" style="overflow-x: auto; max-height: 600px;">
            {{ eda_html|safe }}
        </div>
    {% endif %}

    {% if heatmap_image %}
        <hr>
        <h4 class="mt-4 text-center">Correlation Heatmap</h4>
        <div class="text-center mb-4">
            <img src="data:image/png;base64,{{ heatmap_image }}" class="img-fluid rounded border"
                alt="Heatmap" style="cursor:pointer;"
                data-bs-toggle="modal" data-bs-target="#heatmapModal">
        </div>

        <!-- Modal for enlarged heatmap -->
        <div class="modal fade" id="heatmapModal" tabindex="-1" aria-labelledby="heatmapModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header d-flex justify-content-between align-items-center">
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body text-center">
                        <img src="data:image/png;base64,{{ heatmap_image }}" class="img-fluid" alt="Large Heatmap">
                    </div>
                </div>
            </div>
        </div>
    {% endif %}

    {% if histogram_image %}
        <hr>
        <h4 class="mt-4 text-center">Histogram of Values</h4>
        <div class="text-center mb-4">
            <img src="data:image/png;base64,{{ histogram_image }}" class="img-fluid rounded border"
                alt="Histogram" style="cursor:pointer;"
                data-bs-toggle="modal" data-bs-target="#histogramModal">
        </div>

        <!-- Modal for enlarged histogram -->
        <div class="modal fade" id="histogramModal" tabindex="-1" aria-labelledby="histogramModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header d-flex justify-content-between align-items-center">
                        <h5 class="modal-title" id="histogramModalLabel">Histogram of Values</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body text-center">
                        <img src="data:image/png;base64,{{ histogram_image }}" class="img-fluid" alt="Large Histogram">
                    </div>
                </div>
            </div>
        </div>
    {% endif %}

</div>
{% endblock content %}